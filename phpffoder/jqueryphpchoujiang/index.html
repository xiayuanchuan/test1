<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="keywords" content="html5,本地存储" />
        <meta name="description" content="Helloweba演示平台，演示XHTML、CSS、jquery、PHP案例和示例" />
        <title>幸运大转盘-jQuery+PHP实现的抽奖程序</title>
        <link rel="stylesheet" type="text/css" href="../css/main.css" />
        <style type="text/css">
            .demo{width:417px; height:417px; position:relative; margin:50px auto}
            #disk{width:417px; height:417px; background:url(disk.jpg) no-repeat}
            #start{width:163px; height:320px; position:absolute; top:46px; left:130px;}
            #start img{cursor:pointer}
        </style>
        <script type="text/javascript" src="../../more/jquery.js"></script>
        <script type="text/javascript" src="jQueryRotate.2.2.js"></script>
        <script type="text/javascript" src="jquery.easing.min.js"></script>
        <script type="text/javascript">
            //var a = 0;

            var dataobj;


//            $.get("choujiang.php", function (data) {
//                data = $.parseJSON(data);
//                dataobj = data;
//                a = dataobj.data.id * 30 + data.arang;
//
//            });
            $(function () {
                // console.log("第一次a" + a);

                $("#startbtn").rotate({
                    bind: {
                        click: function () {
                            //var a = Math.floor(Math.random() * 360);
                            var a = getData();
                            alert(a);
                            $(this).rotate({
                                duration: 3000,
                                angle: 0,
                                animateTo: 1440 + a,
                                easing: $.easing.easeOutSine,
                                callback: function () {
                                    console.log("diercia" + a);
                                    // alert(jiangXiang(a));
//                                    alert(dataobj.data.id + "---" + a + "---" + dataobj.data.anme);
//                                    alert(a);
//                                    alert(dataobj.data.anme);
                                    if (dataobj.state === 0) {
                                        alert("sorry! you are late!" + dataobj.data.anme + dataobj.message);
                                    } else {
                                        alert("恭喜中奖啦 ！" + dataobj.data.anme);
                                        // jiangXiang(a);
                                    }

                                }
                            });
                        }
                    }
                });
            });
            var b = null;
            //function 异步
            function getData() {

                $.get("choujiang.php", function (data) {
                    data = $.parseJSON(data);
                    dataobj = data;
                    b = dataobj.data.id * 30 + data.arang;
                    alert("222---" + b);
                });
                return b;
            }
            //判断奖项
            function jiangXiang(a) {
                var jxnum = a / 30;
                jxnum = parseInt(jxnum);
                switch (jxnum) {
                    case 0:
                        jx = "一等奖";
                        break;
                    case 2:
                        jx = "六等奖";
                        break;
                    case 4:
                        jx = "五等奖";
                        break;
                    case 6:
                        jx = "四等奖";
                        break;
                    case 8:
                        jx = "三等奖";
                        break;
                    case 10:
                        jx = "二等奖";
                        break;
                    default:
                        jx = "七等奖";
                }
                return jx;
            }
            function getData1() {
                alert(getData());

            }
        </script>
    </head>

    <body>
        <div id="header">
            <div id="logo"><h1><a href="#" title="返回helloweba首页">helloweba</a></h1></div>
            <div id="logo"><button onclick="getData1()">dianji</button></div>
        </div>

        <div id="main">
            <div class="msg"></div>
            <div class="demo">
                <div id="disk"></div>
                <div id="start"><img src="start.png" id="startbtn"></div>
            </div>

        </div>


        <div id="footer">

        </div>
    </body>
</html>